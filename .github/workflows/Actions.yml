name: RDP-Setup

on:
  workflow_dispatch:

jobs:
  setup-rdp:
    runs-on: ubuntu-latest

    steps:
    - name: Start RDP on Ubuntu-latest
      run: |
        echo "Installing Desktop Environment and xRDP..."
        sudo apt-get update
        sudo apt-get install -y xfce4 xfce4-goodies xorg dbus-x11 x11-xserver-utils xrdp

        echo "Configuring xRDP..."
        sudo systemctl enable xrdp
        sudo adduser xrdp ssl-cert
        sudo systemctl restart xrdp

        echo "Setting default desktop session..."
        echo xfce4-session > ~/.xsession

        echo "Setting password for RDP user..."
        echo "ubuntu:12345" | sudo chpasswd

        echo "Your RDP server is ready!"
        echo "Use the credentials below to connect:"
        echo "-------------------------------------"
        echo "Username: ubuntu"
        echo "Password: 12345"
        echo "-------------------------------------"

        echo "Getting public IP..."
        curl ifconfig.me

        echo "To connect: open Remote Desktop (RDP) and use the IP shown above."

        # Keep RDP session alive
        echo "Keeping session alive for 6 hours..."
        sleep 21600
